# atmaCup17

# 衣服レビュー推薦予測システム

[![Python](https://img.shields.io/badge/Python-3.10+-blue.svg)](https://www.python.org/)
[![PyTorch](https://img.shields.io/badge/PyTorch-2.0+-red.svg)](https://pytorch.org/)
[![Transformers](https://img.shields.io/badge/🤗%20Transformers-4.0+-yellow.svg)](https://huggingface.co/transformers/)
[![LightGBM](https://img.shields.io/badge/LightGBM-3.0+-green.svg)](https://lightgbm.readthedocs.io/)

## 📝 概要

このプロジェクトは、**ATMA Cup #17**で開発された衣服レビューの推薦予測システムです。レビュワーが衣服を推薦するかどうかを予測するため、最新の自然言語処理技術とアンサンブル学習を組み合わせたハイブリッドアプローチを採用しています。

### 🎯 タスク概要
- **課題**: 衣服のレビュー情報から「レビュワーがその商品を推薦するか」を予測
- **評価指標**: AUC (ROC AUC Score)
- **データ**: レビューテキスト、タイトル、レビュワー年齢、衣服属性情報



## 🔧 主要技術

### 1. DeBERTa v3-large モデル
- **ファイル**: `devarta.py`
- **目的**: 高精度なテキスト分類による基準予測の生成
- **特徴**:
  - Microsoft DeBERTa v3-largeの事前学習済みモデルを使用
  - 3フォールド層化交差検証
  - 早期終了による過学習防止
  - アンサンブル予測

### 2. ハイブリッドアンサンブルモデル
- **ファイル**: `lightgbm.py`
- **目的**: 多様な特徴量を統合した最終予測
- **特徴**:
  - DeBERTa予測結果の活用
  - 包括的特徴量エンジニアリング
  - LightGBMによる勾配ブースティング
  - 5フォールド交差検証

## 📊 特徴量設計

| カテゴリ | 特徴量 | 説明 |
|---------|--------|------|
| **テキスト埋め込み** | E5-Large (1024次元) | 多言語対応の密なテキスト表現 |
| **感情分析** | VADER スコア | ポジティブ/ニュートラル/ネガティブ |
| **語彙統計** | 単語数・文字数 | テキストの基本統計情報 |
| **TF-IDF** | 500次元 n-gram | 1-2グラムの語彙重要度 |
| **言語的特徴** | 逆説接続詞 | 「しかし」「ただし」等の存在 |
| **相互作用** | レーティング×フィードバック | 評価と反応の相互関係 |
| **カテゴリ** | 衣服属性 | Division/Department/Class |



## 🎯 性能結果

| モデル | 交差検証AUC | 説明 |
|--------|-------------|------|
| DeBERTa v3-large | 0.950 | テキスト分類ベースライン |
| Ensemble Model | **0.966** | 多特徴量アンサンブル |

## 🔍 技術的ハイライト

### 1. 効率的な計算戦略
- **事前予測活用**: DeBERTaの予測結果を特徴量として使用
- **混合精度**: FP16による高速化
- **動的パディング**: メモリ効率の最適化

### 2. 包括的特徴量エンジニアリング
- **多層的アプローチ**: 統計的特徴から深層表現まで
- **ドメイン知識**: レビュー特有の言語パターンを考慮
- **相互作用特徴**: 非線形関係の捕捉

### 3. 堅牢な検証戦略
- **層化交差検証**: データ分布を保持した分割
- **Out-of-fold予測**: 未見データでの性能評価
- **アンサンブル**: 複数モデルによるリスク分散



## 📄 ライセンス

このプロジェクトはMITライセンスの下で公開されています。詳細は[LICENSE](LICENSE)ファイルをご確認ください。
